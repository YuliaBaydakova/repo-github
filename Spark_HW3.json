{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663496485807_1072968025","id":"20220918-102125_963376948","dateCreated":"2022-09-18T10:21:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:210","text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession \\\n    .builder \\\n    .appName(\"Python Spark SQL basic example\") \\\n    .config(\"spark.some.config.option\", \"some-value\") \\\n    .getOrCreate()","dateUpdated":"2022-09-18T10:23:17+0000","dateFinished":"2022-09-18T10:23:32+0000","dateStarted":"2022-09-18T10:23:17+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n#класс для работы с RDD\nsc = spark.sparkContext","user":"anonymous","dateUpdated":"2022-09-18T12:02:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663496597522_-1422264424","id":"20220918-102317_1156152627","dateCreated":"2022-09-18T10:23:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:369","dateFinished":"2022-09-18T12:02:09+0000","dateStarted":"2022-09-18T12:02:09+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n#создали RDD\ndata_1 = [\n        ('Autumn weather that year'),\n        ('Stood in the yard for a long time'),\n        ('Winter was waiting, nature was waiting'),\n        ('Snow fell only in January'),\n        ('On the third in the night. Waking up early,'),\n        ('Tatiana saw through the window'),\n        ('In the morning , the whitewashed courtyard,'),\n        ('Curtains, roofs and fence,'),\n        ('There are light patterns on the glasses,'),\n        ('Trees in winter silver,'),\n        ('Forty merry in the yard'),\n        ('And softly carpeted mountains'),\n        ('Winters are a resplendent carpet.'),\n        ('Everything is bright, everything is white all around.')\n        ]\n    \ndataRDD = sc.parallelize(data_1)\n\ndataRDD.collect()","user":"anonymous","dateUpdated":"2022-09-18T12:02:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663496896182_1554557603","id":"20220918-102816_1881021572","dateCreated":"2022-09-18T10:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:476","dateFinished":"2022-09-18T12:02:36+0000","dateStarted":"2022-09-18T12:02:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Autumn weather that year',\n 'Stood in the yard for a long time',\n 'Winter was waiting, nature was waiting',\n 'Snow fell only in January',\n 'On the third in the night. Waking up early,',\n 'Tatiana saw through the window',\n 'In the morning , the whitewashed courtyard,',\n 'Curtains, roofs and fence,',\n 'There are light patterns on the glasses,',\n 'Trees in winter silver,',\n 'Forty merry in the yard',\n 'And softly carpeted mountains',\n 'Winters are a resplendent carpet.',\n 'Everything is bright, everything is white all around.']"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=67"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#разделили на строки\n\nrdd2 = dataRDD.zipWithIndex().map(lambda x: (x[1], x[0]))\nrdd2.collect()","user":"anonymous","dateUpdated":"2022-09-18T12:03:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663496922002_594369670","id":"20220918-102842_294197816","dateCreated":"2022-09-18T10:28:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:560","dateFinished":"2022-09-18T12:02:59+0000","dateStarted":"2022-09-18T12:02:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(0, 'Autumn weather that year'),\n (1, 'Stood in the yard for a long time'),\n (2, 'Winter was waiting, nature was waiting'),\n (3, 'Snow fell only in January'),\n (4, 'On the third in the night. Waking up early,'),\n (5, 'Tatiana saw through the window'),\n (6, 'In the morning , the whitewashed courtyard,'),\n (7, 'Curtains, roofs and fence,'),\n (8, 'There are light patterns on the glasses,'),\n (9, 'Trees in winter silver,'),\n (10, 'Forty merry in the yard'),\n (11, 'And softly carpeted mountains'),\n (12, 'Winters are a resplendent carpet.'),\n (13, 'Everything is bright, everything is white all around.')]"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=68"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#разделили на слова\npartition = rdd2.flatMap(lambda x: x[1].split(' '))\npartition.collect()","user":"anonymous","dateUpdated":"2022-09-18T12:03:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663498031118_-1616488364","id":"20220918-104711_728205197","dateCreated":"2022-09-18T10:47:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1072","dateFinished":"2022-09-18T12:03:40+0000","dateStarted":"2022-09-18T12:03:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Autumn',\n 'weather',\n 'that',\n 'year',\n 'Stood',\n 'in',\n 'the',\n 'yard',\n 'for',\n 'a',\n 'long',\n 'time',\n 'Winter',\n 'was',\n 'waiting,',\n 'nature',\n 'was',\n 'waiting',\n 'Snow',\n 'fell',\n 'only',\n 'in',\n 'January',\n 'On',\n 'the',\n 'third',\n 'in',\n 'the',\n 'night.',\n 'Waking',\n 'up',\n 'early,',\n 'Tatiana',\n 'saw',\n 'through',\n 'the',\n 'window',\n 'In',\n 'the',\n 'morning',\n ',',\n 'the',\n 'whitewashed',\n 'courtyard,',\n 'Curtains,',\n 'roofs',\n 'and',\n 'fence,',\n 'There',\n 'are',\n 'light',\n 'patterns',\n 'on',\n 'the',\n 'glasses,',\n 'Trees',\n 'in',\n 'winter',\n 'silver,',\n 'Forty',\n 'merry',\n 'in',\n 'the',\n 'yard',\n 'And',\n 'softly',\n 'carpeted',\n 'mountains',\n 'Winters',\n 'are',\n 'a',\n 'resplendent',\n 'carpet.',\n 'Everything',\n 'is',\n 'bright,',\n 'everything',\n 'is',\n 'white',\n 'all',\n 'around.']"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=69"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#приписали 1 к каждому слову и посчитали сколько раз слово встречается в тексте\nrdd3 = partition.map(lambda x: (x,1)).reduceByKey(lambda x, y: x+y)\nrdd3.collect()","user":"anonymous","dateUpdated":"2022-09-18T12:04:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663499013254_1263995585","id":"20220918-110333_2016156170","dateCreated":"2022-09-18T11:03:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1634","dateFinished":"2022-09-18T12:04:37+0000","dateStarted":"2022-09-18T12:04:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('and', 1),\n ('Tatiana', 1),\n ('all', 1),\n ('Stood', 1),\n ('Winter', 1),\n ('whitewashed', 1),\n ('On', 1),\n ('is', 2),\n ('year', 1),\n ('Snow', 1),\n ('up', 1),\n ('Everything', 1),\n ('weather', 1),\n ('through', 1),\n ('early,', 1),\n ('in', 5),\n ('only', 1),\n ('saw', 1),\n ('Curtains,', 1),\n ('around.', 1),\n ('carpet.', 1),\n ('winter', 1),\n ('for', 1),\n ('that', 1),\n (',', 1),\n ('long', 1),\n ('Waking', 1),\n ('everything', 1),\n ('waiting', 1),\n ('window', 1),\n ('white', 1),\n ('was', 2),\n ('Winters', 1),\n ('bright,', 1),\n ('mountains', 1),\n ('There', 1),\n ('nature', 1),\n ('roofs', 1),\n ('January', 1),\n ('time', 1),\n ('glasses,', 1),\n ('Forty', 1),\n ('fell', 1),\n ('a', 2),\n ('merry', 1),\n ('resplendent', 1),\n ('the', 8),\n ('And', 1),\n ('on', 1),\n ('fence,', 1),\n ('yard', 2),\n ('carpeted', 1),\n ('third', 1),\n ('light', 1),\n ('Trees', 1),\n ('courtyard,', 1),\n ('morning', 1),\n ('Autumn', 1),\n ('patterns', 1),\n ('softly', 1),\n ('In', 1),\n ('silver,', 1),\n ('waiting,', 1),\n ('night.', 1),\n ('are', 2)]"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=71"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2022-09-18T12:03:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663502625531_266222181","id":"20220918-120345_344655346","dateCreated":"2022-09-18T12:03:45+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4723"}],"name":"Spark_HW3","id":"2HDUK2CWY","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}