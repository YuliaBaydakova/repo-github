{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664124483587_-2062817283","id":"20220925-164803_751543537","dateCreated":"2022-09-25T16:48:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:311","text":"%pyspark\n#создали спрак-сессию\nfrom pyspark.sql import SparkSession\n\nspark = (\n    SparkSession\n    .builder\n    .appName(\"MyApp\")\n    .getOrCreate()\n    )","dateUpdated":"2022-09-25T19:02:30+0000","dateFinished":"2022-09-25T19:02:30+0000","dateStarted":"2022-09-25T19:02:30+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n#создали первый датафрейм\nemp = spark.createDataFrame([\n    (0,\"John C\", \"2000-01-01\", \"D101\"),\n    (1,\"Tom D\", \"2002-02-01\", \"D102\"),\n    (2,\"Max\", \"2003-04-01\", \"D104\"),\n    (3,\"Peter J\", \"2005-06-01\", \"D104\"),\n    (4,\"Mark P\", \"2007-01-01\", \"D1022\")\n]).toDF(\"id\",\"name\",\"joining_date\",\"dept_id\")\nemp.show()","user":"anonymous","dateUpdated":"2022-09-25T19:02:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664124502487_2126953799","id":"20220925-164822_1951823000","dateCreated":"2022-09-25T16:48:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:394","dateFinished":"2022-09-25T19:02:32+0000","dateStarted":"2022-09-25T19:02:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+------------+-------+\n| id|   name|joining_date|dept_id|\n+---+-------+------------+-------+\n|  0| John C|  2000-01-01|   D101|\n|  1|  Tom D|  2002-02-01|   D102|\n|  2|    Max|  2003-04-01|   D104|\n|  3|Peter J|  2005-06-01|   D104|\n|  4| Mark P|  2007-01-01|  D1022|\n+---+-------+------------+-------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=152"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#создали второй датафрейм\ndept = spark.createDataFrame([\n    (\"D101\", \"Support\"),\n    (\"D102\", \"HR\"),\n    (\"D103\", \"Marketing\"),\n    (\"D104\", \"Sells\")\n]).toDF(\"id\", \"dept_name\")\n \ndept.show()","user":"anonymous","dateUpdated":"2022-09-25T19:02:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664126517062_1732859369","id":"20220925-172157_412795460","dateCreated":"2022-09-25T17:21:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:509","dateFinished":"2022-09-25T19:02:34+0000","dateStarted":"2022-09-25T19:02:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------+\n|  id|dept_name|\n+----+---------+\n|D101|  Support|\n|D102|       HR|\n|D103|Marketing|\n|D104|    Sells|\n+----+---------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=153"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#объединили первый со вторым\n\nemp.join(dept, emp[\"dept_id\"] == dept[\"id\"], \"inner\").show()","user":"anonymous","dateUpdated":"2022-09-25T19:02:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664126555137_786785716","id":"20220925-172235_1244259767","dateCreated":"2022-09-25T17:22:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:642","dateFinished":"2022-09-25T19:02:38+0000","dateStarted":"2022-09-25T19:02:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+------------+-------+----+---------+\n| id|   name|joining_date|dept_id|  id|dept_name|\n+---+-------+------------+-------+----+---------+\n|  2|    Max|  2003-04-01|   D104|D104|    Sells|\n|  3|Peter J|  2005-06-01|   D104|D104|    Sells|\n|  0| John C|  2000-01-01|   D101|D101|  Support|\n|  1|  Tom D|  2002-02-01|   D102|D102|       HR|\n+---+-------+------------+-------+----+---------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=154","http://172.17.0.2:4040/jobs/job?id=155","http://172.17.0.2:4040/jobs/job?id=156","http://172.17.0.2:4040/jobs/job?id=157","http://172.17.0.2:4040/jobs/job?id=158"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#добавили соль в первый\nfrom pyspark.sql.functions import exp,hash\ndept = dept.withColumn(\"salt\", hash(\"id\"))\ndept.show()","user":"anonymous","dateUpdated":"2022-09-25T19:02:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664127015341_2020790259","id":"20220925-173015_85852199","dateCreated":"2022-09-25T17:30:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:761","dateFinished":"2022-09-25T19:02:48+0000","dateStarted":"2022-09-25T19:02:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------+-----------+\n|  id|dept_name|       salt|\n+----+---------+-----------+\n|D101|  Support| 1234736184|\n|D102|       HR| 1501306384|\n|D103|Marketing|  675850262|\n|D104|    Sells|-1081066963|\n+----+---------+-----------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=159"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#добавили соль во второй\nfrom pyspark.sql.functions import exp,hash\nemp = emp.withColumn(\"salt\", hash(\"dept_id\"))\nemp.show()","user":"anonymous","dateUpdated":"2022-09-25T19:02:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664129835265_-766883823","id":"20220925-181715_1766662147","dateCreated":"2022-09-25T18:17:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:896","dateFinished":"2022-09-25T19:02:51+0000","dateStarted":"2022-09-25T19:02:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+------------+-------+-----------+\n| id|   name|joining_date|dept_id|       salt|\n+---+-------+------------+-------+-----------+\n|  0| John C|  2000-01-01|   D101| 1234736184|\n|  1|  Tom D|  2002-02-01|   D102| 1501306384|\n|  2|    Max|  2003-04-01|   D104|-1081066963|\n|  3|Peter J|  2005-06-01|   D104|-1081066963|\n|  4| Mark P|  2007-01-01|  D1022|  420410849|\n+---+-------+------------+-------+-----------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=160"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#объединили + отсортировали\nemp.join(dept, emp[\"salt\"] == dept[\"salt\"], \"inner\").select(emp.id,\"name\",\"joining_date\",\"dept_id\",\"dept_name\").sort(emp.id).show()\n#emp.join(dept, emp[\"salt\"] == dept[\"salt\"], \"inner\").show()","user":"anonymous","dateUpdated":"2022-09-25T19:02:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664129964065_-1317158549","id":"20220925-181924_78678402","dateCreated":"2022-09-25T18:19:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1130","dateFinished":"2022-09-25T19:02:56+0000","dateStarted":"2022-09-25T19:02:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+------------+-------+---------+\n| id|   name|joining_date|dept_id|dept_name|\n+---+-------+------------+-------+---------+\n|  0| John C|  2000-01-01|   D101|  Support|\n|  1|  Tom D|  2002-02-01|   D102|       HR|\n|  2|    Max|  2003-04-01|   D104|    Sells|\n|  3|Peter J|  2005-06-01|   D104|    Sells|\n+---+-------+------------+-------+---------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=161"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2022-09-25T18:19:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664129998419_-1749889663","id":"20220925-181958_2139740767","dateCreated":"2022-09-25T18:19:58+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1252"}],"name":"Spark_HW6","id":"2HGFNQDX3","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}