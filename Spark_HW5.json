{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664114187336_691986053","id":"20220925-135627_1479240794","dateCreated":"2022-09-25T13:56:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:272","text":"%pyspark\n#создали спрак-сессию\nfrom pyspark.sql import SparkSession\n\nspark = (\n    SparkSession\n    .builder\n    .appName(\"MyApp\")\n    .getOrCreate()\n    )","dateUpdated":"2022-09-25T14:08:22+0000","dateFinished":"2022-09-25T14:08:22+0000","dateStarted":"2022-09-25T14:08:22+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n#прочитали файл по ссылке\nurl = 'https://s3.amazonaws.com/apache-zeppelin/tutorial/bank/bank.csv'\nfrom pyspark import SparkFiles\nspark.sparkContext.addFile(url)","user":"anonymous","dateUpdated":"2022-09-25T14:08:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664114448086_938082552","id":"20220925-140048_1332035055","dateCreated":"2022-09-25T14:00:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1055","dateFinished":"2022-09-25T14:08:23+0000","dateStarted":"2022-09-25T14:08:23+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n#прочитали данные из файла\ndf = spark.read.csv(\"file://\"+SparkFiles.get(\"bank.csv\"), sep=';', header=True,inferSchema = True)","user":"anonymous","dateUpdated":"2022-09-25T14:08:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664114464372_-23206145","id":"20220925-140104_1611219445","dateCreated":"2022-09-25T14:01:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1142","dateFinished":"2022-09-25T14:08:26+0000","dateStarted":"2022-09-25T14:08:25+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=19","http://172.17.0.2:4040/jobs/job?id=20"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#создали временную таблицу\ndf.registerTempTable(\"bank\")","user":"anonymous","dateUpdated":"2022-09-25T14:08:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664114494244_247750877","id":"20220925-140134_132513895","dateCreated":"2022-09-25T14:01:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1255","dateFinished":"2022-09-25T14:08:28+0000","dateStarted":"2022-09-25T14:08:28+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\n--расширенный план запроса\nEXPLAIN EXTENDED select age, count(1) value\nfrom bank \ngroup by age\nlimit 3","user":"anonymous","dateUpdated":"2022-09-25T14:08:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"plan":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664114222967_244896654","id":"20220925-135702_1195700405","dateCreated":"2022-09-25T13:57:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:358","dateFinished":"2022-09-25T14:08:44+0000","dateStarted":"2022-09-25T14:08:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"plan\n== Parsed Logical Plan ==\n'GlobalLimit 3\n+- 'LocalLimit 3\n   +- 'Aggregate ['age], ['age, 'count(1) AS value#369]\n      +- 'UnresolvedRelation `bank`\n== Analyzed Logical Plan ==\nage: int, value: bigint\nGlobalLimit 3\n+- LocalLimit 3\n   +- Aggregate [age#333], [age#333, count(1) AS value#369L]\n      +- SubqueryAlias bank\n         +- Relation[age#333,job#334,marital#335,education#336,default#337,balance#338,housing#339,loan#340,contact#341,day#342,month#343,duration#344,campaign#345,pdays#346,previous#347,poutcome#348,y#349] csv\n== Optimized Logical Plan ==\nGlobalLimit 3\n+- LocalLimit 3\n   +- Aggregate [age#333], [age#333, count(1) AS value#369L]\n      +- Project [age#333]\n         +- Relation[age#333,job#334,marital#335,education#336,default#337,balance#338,housing#339,loan#340,contact#341,day#342,month#343,duration#344,campaign#345,pdays#346,previous#347,poutcome#348,y#349] csv\n== Physical Plan ==\nCollectLimit 3\n+- *HashAggregate(keys=[age#333], functions=[count(1)], output=[age#333, value#369L])\n   +- Exchange hashpartitioning(age#333, 200)\n      +- *HashAggregate(keys=[age#333], functions=[partial_count(1)], output=[age#333, count#374L])\n         +- *FileScan csv [age#333] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/tmp/spark-f8994802-9c1d-4e10-83e2-ee6944f6a1a6/userFiles-51341a85-186f-44..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<age:int>\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\n--физический план запрса\nEXPLAIN select age, count(1) value\nfrom bank \nwhere education=\"${education=secondary}\" \ngroup by age\norder by value","user":"anonymous","dateUpdated":"2022-09-25T14:09:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"plan":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{"education":"secondary"},"forms":{"education":{"type":"TextBox","name":"education","defaultValue":"secondary","hidden":false,"$$hashKey":"object:3349"}}},"apps":[],"jobName":"paragraph_1664114316529_647958919","id":"20220925-135836_1619493926","dateCreated":"2022-09-25T13:58:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:452","dateFinished":"2022-09-25T14:09:01+0000","dateStarted":"2022-09-25T14:09:01+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"plan\n== Physical Plan ==\n*Sort [value#379L ASC NULLS FIRST], true, 0\n+- Exchange rangepartitioning(value#379L ASC NULLS FIRST, 200)\n   +- *HashAggregate(keys=[age#333], functions=[count(1)])\n      +- Exchange hashpartitioning(age#333, 200)\n         +- *HashAggregate(keys=[age#333], functions=[partial_count(1)])\n            +- *Project [age#333]\n               +- *Filter (isnotnull(education#336) && (education#336 = secondary))\n                  +- *FileScan csv [age#333,education#336] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/tmp/spark-f8994802-9c1d-4e10-83e2-ee6944f6a1a6/userFiles-51341a85-186f-44..., PartitionFilters: [], PushedFilters: [IsNotNull(education), EqualTo(education,secondary)], ReadSchema: struct<age:int,education:string>\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\nEXPLAIN COST select age, count(1) value\nfrom bank \nwhere education=\"${education=secondary}\" \ngroup by age\norder by value","user":"anonymous","dateUpdated":"2022-09-25T14:21:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"plan":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{"education":"secondary"},"forms":{"education":{"type":"TextBox","name":"education","defaultValue":"secondary","hidden":false,"$$hashKey":"object:4659"}}},"apps":[],"jobName":"paragraph_1664114616214_463496633","id":"20220925-140336_349134261","dateCreated":"2022-09-25T14:03:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1977","dateFinished":"2022-09-25T14:21:42+0000","dateStarted":"2022-09-25T14:21:42+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"plan\n== Parsed Logical Plan ==\n'Sort ['value ASC NULLS FIRST], true\n+- 'Aggregate ['age], ['age, 'count(1) AS value#390]\n   +- 'Filter ('education = secondary)\n      +- 'UnresolvedRelation `bank`\n== Analyzed Logical Plan ==\nage: int, value: bigint\nSort [value#390L ASC NULLS FIRST], true\n+- Aggregate [age#333], [age#333, count(1) AS value#390L]\n   +- Filter (education#336 = secondary)\n      +- SubqueryAlias bank\n         +- Relation[age#333,job#334,marital#335,education#336,default#337,balance#338,housing#339,loan#340,contact#341,day#342,month#343,duration#344,campaign#345,pdays#346,previous#347,poutcome#348,y#349] csv\n== Optimized Logical Plan ==\nSort [value#390L ASC NULLS FIRST], true, Statistics(sizeInBytes=38.2 KB, hints=none)\n+- Aggregate [age#333], [age#333, count(1) AS value#390L], Statistics(sizeInBytes=38.2 KB, hints=none)\n   +- Project [age#333], Statistics(sizeInBytes=22.9 KB, hints=none)\n      +- Filter (isnotnull(education#336) && (education#336 = secondary)), Statistics(sizeInBytes=450.7 KB, hints=none)\n         +- Relation[age#333,job#334,marital#335,education#336,default#337,balance#338,housing#339,loan#340,contact#341,day#342,month#343,duration#344,campaign#345,pdays#346,previous#347,poutcome#348,y#349] csv, Statistics(sizeInBytes=450.7 KB, hints=none)\n== Physical Plan ==\n*Sort [value#390L ASC NULLS FIRST], true, 0\n+- Exchange rangepartitioning(value#390L ASC NULLS FIRST, 200)\n   +- *HashAggregate(keys=[age#333], functions=[count(1)], output=[age#333, value#390L])\n      +- Exchange hashpartitioning(age#333, 200)\n         +- *HashAggregate(keys=[age#333], functions=[partial_count(1)], output=[age#333, count#396L])\n            +- *Project [age#333]\n               +- *Filter (isnotnull(education#336) && (education#336 = secondary))\n                  +- *FileScan csv [age#333,education#336] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/tmp/spark-f8994802-9c1d-4e10-83e2-ee6944f6a1a6/userFiles-51341a85-186f-44..., PartitionFilters: [], PushedFilters: [IsNotNull(education), EqualTo(education,secondary)], ReadSchema: struct<age:int,education:string>\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2022-09-25T14:21:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1664115702095_1128421008","id":"20220925-142142_412188400","dateCreated":"2022-09-25T14:21:42+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4073"}],"name":"Spark_HW5","id":"2HECP8XCB","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}